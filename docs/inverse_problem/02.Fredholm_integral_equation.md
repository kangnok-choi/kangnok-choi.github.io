# 02. Fredholm Integral Equation
Fredholm integral equation을 배워보자. Fredholm integral equation of the first-kind는 다음과 같이 정의된다.

$$\int_0^1 K(s, t) f(t) dt = g(s), \quad 0 \leq s \leq 1$$

Forward computation에서는 function $f$와 kernel $K$가 주어질 때, $g$를 계산한다. 반면, inverse problem에서는 kernel $K$와 관측된 함수 $g$가 주어졌을 때, 이를 만족하는 $f$를 복원하고자 한다. 여기에서, $f$와 $g$가 선형 관계이기 때문에,  Kernel $K$로 인해 두 함수 관계의 정량적 특성이 결정된다. 

<details>
<summary>Linear relationship between $f$ and $g$</summary>
<div markdown="1">
\[
\begin{aligned}
(Tf)(s) &:= \int_{0}^{1} K(s, t) f(t) dt\\
\\
T(f_1 + f_2)(s) &= \int_{0}^{1} K(s, t) [f_1(t) + f_2(t)] dt\\
&= \int_{0}^{1} K(s, t)f_1(t) dt + \int_{0}^{1} K(s, t)f_2(t) dt\\
&= (Tf_1)(s) + (Tf_2)(s)\\
\\
T(\alpha f)(s) &= \int_{0}^{1} K(s, t)\alpha f(t) dt\\
&= \alpha \int_{0}^{1}K(s, t) f(t) dt\\
&= \alpha(Tf)(s)
\end{aligned}
\]
</div>
</details>

특히, $K(s, t) = h(s-t)$로 표현될 때, forward problem은 convolution, inverse problem은 deconvolution problem이 된다.

## 1. Examples

![alt text](images/inverse_problem_examples.png)

- **Image deblurring example**

    만약 해결하고자 하는 문제가 image deblurring이라면, $f$ (source)는 이상적인 원본 이미지, $g$ (data)는 blur가 적용된 관측 이미지, kernel $K$는 영상 시스템의 point spread function(PSF)에 해당한다. 이때, forward problem은 원본 이미지 $f$와 PSF $K$를 통해 blurred image를 얻는 과정이 되고, inverse problem은 blurred image $g$와 known kernel (PSF) $K$가 주어졌을 때 이상적인 원본 이미지 $f$를 복원하는 문제가 된다. 

    여기에서 $f$라는 것이 카메라로 찍은 원본 이미지가 아니라, 이상적인 (실제 존재하는) 이미지로 이해하는것이 좋을 것 같다. $g$가 이러한 이상적인 이미지가 실제 카메라의 광학계와 센서를 거치며 PSF에 왜곡되어 측정한 결과이다. PSF는 카레마 촬영 과정에서 발생하는 blurring 현상을 물리적으로 모델링한 것으로, 측정 시스템의 본질적인 특성을 나타낸다.

- **Gravity surveying example**

    마찬가지로, 해결하고자 하는 문제가 gravity surveying이라면, $f$ (source)는 지하의 질량 분포, $g$ (data)는 지표에서 측정된 중력장 성분, kernel $K$는 단위 점질량이 만들어내는 중력장을 나타내는 함수에 해당한다. 이때, forward problem은 질량 분포 $f$와 커널 $K$가 주어졌을 때 관측 위치에서의 중력장 성분 $g$를 계산하는 과정이 되고, inverse problem은 측정된 중력 데이터 $g$와 알려진 물리 커널 $K$가 주어졌을 때 지하의 질량 분포 $f$를 추정하는 문제가 된다.

    여기에서 $f$는 우리가 직접 관측할 수 없는 지하의 원인에 해당하며, $g$는 그 원인이 물리 법칙(뉴턴의 만유인력 법칙)에 따라 공간적으로 누적되어 나타난 결과에 해당한다. 커널 $K$는 점질량이 관측점에 미치는 중력 기여를 정량화한 것으로, 질량 분포의 각 위치가 관측 데이터에 어떻게 반영되는지를 물리적으로 모델링한다. 따라서 중력 탐지의 inverse problem은 관측된 중력장 데이터로부터 지하 질량 분포를 추정하는 과정이며, 적분 과정이 본질적으로 정보를 smoothing하기 때문에 불안정성이 나타날 수 있다.

- **Model training example**

    딥러닝 모델 학습 관점에 Fredholm integral equation을 적용해보자. 이 관점은 gravity surveying과 매우 유사하다고 볼 수 있다. gravity surveying에서 지하의 보이지 않는 질량 분포 $f$가 중력장 $g$를 만들어 내는 것과 같이, 모델 학습에서는 방대한 데이터 분포 $f$를 통해 학습하여 모델의 가중치 $g$를 형성한다. 구체적으로, $f$는 학습 데이터셋, $g$는 학습된 모델의 가중치로 비유할 수 있고, kernel $K$는 학습 알고리즘 및 모델 구조에 대응되어 데이터의 정보가 가중치에 어떻게 누적될지를 결정하는 물리 법칙 역할을 한다. 여기에서의 forward problem은 학습 데이터셋 $f$을 특정 알고리즘/모델 $K$를 통해 학습하여 $g$를 얻는 일반적인 모델 학습 과정이다. Inverse problem은 학습된 모델 가중치 $g$와 kernel $K$가 주어졌을 때 학습 데이터 $f$를 추정하는 문제이다. 

    중력 탐지에서 여러 질량이 합쳐져 하나의 중력장을 만들 때 정보의 smoothing이 일어나듯, 모델 학습에서는 수많은 학습 데이터를 통해 개별 데이터의 정보가 손실된다. 따라서 $g$에서 $f$를 찾는 inverse problem의 경우, ill-posed problem이다.

- **Model inference example**

    Task가 image classification이라고 해보면, $f$는 이미지, $K$는 학습된 모델, $g$는 모델의 output에 해당한다. forward problem은 고차원 이미지 $f$와 모델 $K$가 주어졌을 때 답변 $g$를 inference하는 과정이고, inverse problem은 모델 $K$와 답변 $g$가 주어졌을 때 이미지 $f$를 추론하는 과정에 해당한다. 이 예시에서 또한 압축된 label $g$로부터 원래의 픽셀 정보 $f$를 재구성하는 것이므로, 해가 유일하지 않고 불안정한 ill-posed problem의 전형적인 모습을 보여준다.

이 모든 예시는 $g(s) = \int_0^1 K(s, t) f(t) dt $ 형태의 first-kind Fredholm integral equation으로 정리할 수 있다. 여기에서 kernel $K$가 정보를 smoothing하는 성질을 가질수록, inverse problem은 수치적으로 불안정한 ill-poseness를 가지게된다.

## 2. Riemann-Lebesgue Lemma

Riemann-Lebesgue lemma는 이러한 현상을 수학적으로 증명한다. $f_p$를 다음과 같이 정의하자:

$$f_p(t) = \sin(2 \pi p t), \quad p = 1, 2, \ldots ,$$

임의의 kernel $K$가 있을 때, 다음을 알 수 있다. 

$$g_p(s) = \int_{0}^{1} K(s, t) f_p(t)dt \to 0 \quad \text{for} \quad p\to \infty$$

| ![](images/higher_freq_damped_g.png) |
|:--:|
| **Figure 1.** Blurred image caused by PSF |


이 식은 물리적으로 매우 중요한 함의를 갖는다. 입력 신호 $f$의 주파수($p$)가 높아질수록 관측 데이터 $g_p$의 크기는 급격히 작아져 결국 0에 수렴하게 된다. 즉, $f$에서 $g$로 가는 매핑 과정에서 $f$의 고주파 성분(미세한 디테일)은 감쇄(damped)되고, 결과물인 $g$는 $f$보다 훨씬 부드러운 형태(smoothing)를 갖게 되는 것이다. Figure 1은 $p$(주파수)가 커짐에 따라 $g$의 값이 작아지는 것을 보여준다. 

역문제는 바로 이 평활화된 $g$로부터 원래의 $f$를 복원하는 과정이다. 수학적으로 이는 사라진 고주파 성분을 강제로 다시 증폭시키는 작업과 같으며, 주파수가 높을수록 증폭해야 하는 정도가 기하급수적으로 커진다. 이 과정에서 아주 미세한 측정 노이즈조차 함께 증폭되어 solution을 완전히 왜곡시키기 때문에 역문제가 본질적인 불안정성을 갖게 되는 것이다.

